<!DOCTYPE html>
<html class="dark" lang="en"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>New Shift Report - ibe160</title>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet"/>
<script src="https://cdn.tailwindcss.com?plugins=forms,typography"></script>
<script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              primary: '#3abff8', // sky-400
              'background-light': '#f5f7f8', // gray-100
              'background-dark': '#101d23', // gray-900
              'content-light': '#ffffff', // white
              'content-dark': '#182c34', // gray-800
              'text-primary-light': '#e0e0e0', // gray-800
              'text-primary-dark': '#f9fafb', // gray-50
              'text-secondary-light': '#a0a0a0', // gray-500
              'text-secondary-dark': '#a0a0a0', // gray-400
              'border-light': '#305869', // gray-200
              'border-dark': '#305869', // gray-700
              'success': '#22c55e', // green-500
              'error': '#f43f5e', // rose-500
            },
            fontFamily: {
              display: ['Inter', 'sans-serif'],
            },
            borderRadius: {
              DEFAULT: '0.5rem',
            },
          },
        },
      };
    </script>
<style>
        .material-symbols-outlined {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
            vertical-align: middle;
        }

    </style>
</head>
<body class="font-display bg-background-light dark:bg-background-dark text-text-primary-light dark:text-text-primary-dark">
<div class="flex h-screen" id="app-container">

<main class="flex-1 p-8 overflow-y-auto transition-all duration-300">
<div class="max-w-4xl mx-auto">
<header class="flex justify-between items-center mb-6">
<h2 class="text-2xl font-bold text-text-primary-light dark:text-text-primary-dark">New Shift Report</h2>
<button class="px-4 py-2 text-sm font-medium rounded-md border border-border-light dark:border-border-dark text-text-primary-light dark:text-text-primary-dark bg-content-light dark:bg-content-dark hover:bg-background-light dark:hover:bg-background-dark focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary focus:ring-offset-background-light dark:focus:ring-offset-background-dark transition-all" type="button">
                    Cancel
                </button>
</header>
<form class="space-y-6">
<div class="bg-content-light dark:bg-content-dark p-6 rounded-lg shadow-sm border border-border-light dark:border-border-dark">
<h3 class="text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-4">Shift Summary</h3>
<div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 mb-6">
<div>
<label class="block text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark mb-1.5" for="date-summary">Date *</label>
<input class="block w-full rounded-md border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark placeholder:text-text-secondary-light dark:placeholder:text-text-secondary-dark focus:border-primary focus:ring-primary text-sm" id="date-summary" name="date" type="date" value="2023-10-27"/>
</div>
<div>
<label class="block text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark mb-1.5" for="shift-summary">Shift *</label>
<select class="block w-full rounded-md border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark focus:border-primary focus:ring-primary text-sm" id="shift-summary" name="shift">
<option>Morning (06:00-14:00)</option>
<option selected="">Evening (14:00-22:00)</option>
<option>Night (22:00-06:00)</option>
</select>
</div>
</div>
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
<div class="bg-background-light dark:bg-background-dark p-4 rounded-md border border-border-light dark:border-border-dark">
<p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">Absent Hours</p>
<p id="summary-absent-hours" class="text-xl font-bold text-text-primary-light dark:text-text-primary-dark">16</p>
</div>
<div class="bg-background-light dark:bg-background-dark p-4 rounded-md border border-border-light dark:border-border-dark">
<p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">Hired Hours</p>
<p id="summary-hired-hours" class="text-xl font-bold text-text-primary-light dark:text-text-primary-dark">12</p>
</div>
<div class="bg-background-light dark:bg-background-dark p-4 rounded-md border border-border-light dark:border-border-dark">
<p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">Hired Out Hours</p>
<p id="summary-hired-out-hours" class="text-xl font-bold text-text-primary-light dark:text-text-primary-dark">4</p>
</div>
<div class="bg-background-light dark:bg-background-dark p-4 rounded-md border border-border-light dark:border-border-dark">
<p class="text-sm font-medium text-text-secondary-light dark:text-text-secondary-dark">Overtime Hours</p>
<p id="summary-overtime-hours" class="text-xl font-bold text-text-primary-light dark:text-text-primary-dark">5</p>
</div>
</div>
</div>
<div class="bg-content-light dark:bg-content-dark p-6 rounded-lg shadow-sm border border-border-light dark:border-border-dark">
<h3 class="text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-4">Absent Employees</h3>
<div class="rounded-md border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark">
<div class="flow-root">
<div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
<div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
<table class="min-w-full divide-y divide-border-light dark:divide-border-dark">
<thead>
<tr>
<th class="py-3.5 pl-4 pr-3 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider sm:pl-0" scope="col">Full Name</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Absent Code</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Hours Absent</th>
<th class="relative py-3.5 pl-3 pr-4 sm:pr-0" scope="col"><span class="sr-only">Remove</span></th>
</tr>
</thead>
<tbody id="absent-employees-tbody" class="divide-y divide-border-light dark:divide-border-dark">
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name" value="Jane Doe" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="text" name="absent-code" value="SICK" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-absent" value="8" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name" value="John Smith" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="text" name="absent-code" value="PTO" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-absent" value="8" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="py-3 pl-4 pr-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark sm:pl-0" colspan="2">Total Absent Hours</td>
<td id="total-absent-hours-cell" class="px-3 py-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark">16</td>
<td class="py-3 pl-3 pr-4 sm:pr-0"></td>
</tr>
</tfoot>
</table>
</div>
</div>
</div>
</div>
<div class="mt-4 flex gap-x-4">
<button id="add-absent-employee-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">add</span>
Add Employee
</button>
<button id="copy-yesterday-absent-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">content_copy</span>
Copy from Yesterday
</button>
</div>
</div>
<div class="bg-content-light dark:bg-content-dark p-6 rounded-lg shadow-sm border border-border-light dark:border-border-dark">
<h3 class="text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-4">Hired Employees</h3>
<div class="rounded-md border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark">
<div class="flow-root">
<div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
<div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
<table class="min-w-full divide-y divide-border-light dark:divide-border-dark">
<thead>
<tr>
<th class="py-3.5 pl-4 pr-3 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider sm:pl-0" scope="col">Full Name</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Shift Hired From</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Hours Worked</th>
<th class="relative py-3.5 pl-3 pr-4 sm:pr-0" scope="col"><span class="sr-only">Remove</span></th>
</tr>
</thead>
<tbody id="hired-employees-tbody" class="divide-y divide-border-light dark:divide-border-dark">
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name-hired" value="Mike Johnson" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="text" name="shift-hired-from" value="Morning (06:00-14:00)" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-worked" value="4" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name-hired" value="Sarah Miller" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="text" name="shift-hired-from" value="Morning (06:00-14:00)" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-worked" value="8" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="py-3 pl-4 pr-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark sm:pl-0" colspan="2">Total Hired Hours</td>
<td id="total-hired-hours-cell" class="px-3 py-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark">12</td>
<td class="py-3 pl-3 pr-4 sm:pr-0"></td>
</tr>
</tfoot>
</table>
</div>
</div>
</div>
</div>
<div class="mt-4 flex gap-x-4">
<button id="add-hired-employee-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">add</span>
Add Employee
</button>
<button id="copy-yesterday-hired-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">content_copy</span>
Copy from Yesterday
</button>
</div>
</div>
<div class="bg-content-light dark:bg-content-dark p-6 rounded-lg shadow-sm border border-border-light dark:border-border-dark">
<h3 class="text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-4">Hired Out Employees</h3>
<div class="rounded-md border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark">
<div class="flow-root">
<div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
<div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
<table class="min-w-full divide-y divide-border-light dark:divide-border-dark">
<thead>
<tr>
<th class="py-3.5 pl-4 pr-3 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider sm:pl-0" scope="col">Full Name</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Shift Hired To</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Hours Hired Out</th>
<th class="relative py-3.5 pl-3 pr-4 sm:pr-0" scope="col"><span class="sr-only">Remove</span></th>
</tr>
</thead>
<tbody id="hired-out-employees-tbody" class="divide-y divide-border-light dark:divide-border-dark">
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name-hired-out" value="Emily White" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="text" name="shift-hired-to" value="Night (22:00-06:00)" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-hired-out" value="4" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="py-3 pl-4 pr-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark sm:pl-0" colspan="2">Total Hours Hired Out</td>
<td id="total-hired-out-hours-cell" class="px-3 py-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark">4</td>
<td class="py-3 pl-3 pr-4 sm:pr-0"></td>
</tr>
</tfoot>
</table>
</div>
</div>
</div>
</div>
<div class="mt-4 flex gap-x-4">
<button id="add-hired-out-employee-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">add</span>
Add Employee
</button>
<button id="copy-yesterday-hired-out-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">content_copy</span>
Copy from Yesterday
</button>
</div>
</div>
<div class="bg-content-light dark:bg-content-dark p-6 rounded-lg shadow-sm border border-border-light dark:border-border-dark">
<h3 class="text-xl font-semibold text-text-primary-light dark:text-text-primary-dark mb-4">Overtime Employees</h3>
<div class="rounded-md border border-border-light dark:border-border-dark bg-background-light dark:bg-background-dark">
<div class="flow-root">
<div class="-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8">
<div class="inline-block min-w-full py-2 align-middle sm:px-6 lg:px-8">
<table class="min-w-full divide-y divide-border-light dark:divide-border-dark">
<thead>
<tr>
<th class="py-3.5 pl-4 pr-3 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider sm:pl-0" scope="col">Full Name</th>
<th class="px-3 py-3.5 text-left text-xs font-semibold text-text-secondary-light dark:text-text-secondary-dark uppercase tracking-wider" scope="col">Hours Worked Overtime</th>
<th class="relative py-3.5 pl-3 pr-4 sm:pr-0" scope="col"><span class="sr-only">Remove</span></th>
</tr>
</thead>
<tbody id="overtime-employees-tbody" class="divide-y divide-border-light dark:divide-border-dark">
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name-overtime" value="Chris Green" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-overtime" value="2" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
<tr>
<td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0">
    <input type="text" name="full-name-overtime" value="David Brown" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark">
</td>
<td class="whitespace-nowrap px-3 py-2 text-sm">
    <input type="number" name="hours-overtime" value="3" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark">
</td>
<td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0">
    <button type="button" class="text-error remove-btn font-bold">×</button>
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td class="py-3 pl-4 pr-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark sm:pl-0">Total Overtime Hours</td>
<td id="total-overtime-hours-cell" class="px-3 py-3 text-left text-sm font-semibold text-text-primary-light dark:text-text-primary-dark">5</td>
<td class="py-3 pl-3 pr-4 sm:pr-0"></td>
</tr>
</tfoot>
</table>
</div>
</div>
</div>
</div>
<div class="mt-4 flex gap-x-4">
<button id="add-overtime-employee-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">add</span>
Add Employee
</button>
<button id="copy-yesterday-overtime-btn" type="button" class="flex items-center justify-center gap-2 rounded-md border border-dashed border-border-dark px-4 py-2 text-sm font-medium text-text-secondary-dark hover:bg-background-dark hover:border-solid hover:text-text-primary-dark transition-all">
<span class="material-symbols-outlined text-base">content_copy</span>
Copy from Yesterday
</button>
</div>
</div>

<div class="flex justify-between pt-2">
<button type="button" onclick="window.location.href='Mockup-SR2.html'" class="flex min-w-[120px] cursor-pointer items-center justify-center overflow-hidden rounded-md h-12 px-6 bg-transparent border border-border-dark text-text-primary-light dark:text-text-primary-dark text-base font-bold leading-normal tracking-wide hover:bg-content-dark transition-colors">
<span class="truncate">Back</span>
</button>
<button type="button" onclick="window.location.href='Mockup-SR4.html'" class="flex min-w-[120px] cursor-pointer items-center justify-center overflow-hidden rounded-md h-12 px-6 bg-primary text-background-dark text-base font-bold leading-normal tracking-wide hover:bg-primary/90 transition-colors">
<span class="truncate">Continue</span>
</button>
</div>
</form>
</div>
</main>
</div>

</body>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        // --- Mock Data ---
        const previousDayData = {
            absent: [
                { name: 'Peter Jones', code: 'SICK', hours: 8 },
                { name: 'Mary Smith', code: 'SICK', hours: 4 }
            ],
            hired: [
                { 'full-name-hired': 'Gary Clark Jr.', 'shift-hired-from': 'Morning', 'hours-worked': 8 }
            ],
            hiredOut: [
                { 'full-name-hired-out': 'Susan Tedeschi', 'shift-hired-to': 'Night', 'hours-hired-out': 6 }
            ],
            overtime: [
                { 'full-name-overtime': 'Derek Trucks', 'hours-overtime': 2 }
            ]
        };

        // --- Core Function for Table Logic ---
        function initializeDynamicTable(tbodyId, addBtnId, totalCellId, summaryId, hourInputName, newRowHtml) {
            const tbody = document.getElementById(tbodyId);
            if (!tbody) return;

            const addBtn = document.getElementById(addBtnId);
            const totalCell = document.getElementById(totalCellId);
            const summaryP = document.getElementById(summaryId);

            function updateTotals() {
                let totalHours = 0;
                const hourInputs = tbody.querySelectorAll(`input[name="${hourInputName}"]`);
                hourInputs.forEach(input => {
                    totalHours += Number(input.value) || 0;
                });

                if (totalCell) totalCell.textContent = totalHours;
                if (summaryP) summaryP.textContent = totalHours;
            }

            function addRow(data = null) {
                const newRow = document.createElement('tr');
                newRow.innerHTML = newRowHtml;
                if (data) {
                    Object.keys(data).forEach(key => {
                        const input = newRow.querySelector(`[name="${key}"]`);
                        if (input) {
                            input.value = data[key];
                        }
                    });
                }
                tbody.appendChild(newRow);
            }

            if (addBtn) {
                addBtn.addEventListener('click', () => addRow());
            }

            tbody.addEventListener('input', function(e) {
                if (e.target.matches(`input[name="${hourInputName}"]`)) {
                    updateTotals();
                }
            });

            tbody.addEventListener('click', function(e) {
                if (e.target.matches('.remove-btn')) {
                    e.target.closest('tr').remove();
                    updateTotals();
                }
            });

            updateTotals();
            return { addRow, updateTotals };
        }
        
        function setupCopyButton(buttonId, tbodyId, data, tableController) {
            const copyBtn = document.getElementById(buttonId);
            if (copyBtn && tableController) {
                copyBtn.addEventListener('click', () => {
                    const tbody = document.getElementById(tbodyId);
                    tbody.innerHTML = ''; // Clear existing rows
                    data.forEach(employeeData => {
                        tableController.addRow(employeeData);
                    });
                    tableController.updateTotals();
                });
            }
        }

        // --- Table Initializations ---

        // Absent
        const absentNewRowHtml = `
            <td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0"><input type="text" name="name" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark" placeholder="Full Name"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="text" name="code" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="e.g., SICK"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="number" name="hours" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="Hours" value="0"></td>
            <td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0"><button type="button" class="text-error remove-btn font-bold">×</button></td>`;
        const absentTable = initializeDynamicTable('absent-employees-tbody', 'add-absent-employee-btn', 'total-absent-hours-cell', 'summary-absent-hours', 'hours', absentNewRowHtml);
        setupCopyButton('copy-yesterday-absent-btn', 'absent-employees-tbody', previousDayData.absent, absentTable);

        // Hired
        const hiredNewRowHtml = `
            <td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0"><input type="text" name="full-name-hired" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark" placeholder="Full Name"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="text" name="shift-hired-from" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="e.g., Morning"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="number" name="hours-worked" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="Hours" value="0"></td>
            <td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0"><button type="button" class="text-error remove-btn font-bold">×</button></td>`;
        const hiredTable = initializeDynamicTable('hired-employees-tbody', 'add-hired-employee-btn', 'total-hired-hours-cell', 'summary-hired-hours', 'hours-worked', hiredNewRowHtml);
        setupCopyButton('copy-yesterday-hired-btn', 'hired-employees-tbody', previousDayData.hired, hiredTable);

        // Hired Out
        const hiredOutNewRowHtml = `
            <td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0"><input type="text" name="full-name-hired-out" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark" placeholder="Full Name"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="text" name="shift-hired-to" class="w-full bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="e.g., Night"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="number" name="hours-hired-out" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="Hours" value="0"></td>
            <td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0"><button type="button" class="text-error remove-btn font-bold">×</button></td>`;
        const hiredOutTable = initializeDynamicTable('hired-out-employees-tbody', 'add-hired-out-employee-btn', 'total-hired-out-hours-cell', 'summary-hired-out-hours', 'hours-hired-out', hiredOutNewRowHtml);
        setupCopyButton('copy-yesterday-hired-out-btn', 'hired-out-employees-tbody', previousDayData.hiredOut, hiredOutTable);

        // Overtime
        const overtimeNewRowHtml = `
            <td class="whitespace-nowrap py-2 pl-4 pr-3 text-sm font-medium sm:pl-0"><input type="text" name="full-name-overtime" class="w-full bg-transparent border-0 focus:ring-0 text-text-primary-light dark:text-text-primary-dark" placeholder="Full Name"></td>
            <td class="whitespace-nowrap px-3 py-2 text-sm"><input type="number" name="hours-overtime" class="w-20 bg-transparent border-0 focus:ring-0 text-text-secondary-light dark:text-text-secondary-dark" placeholder="Hours" value="0"></td>
            <td class="whitespace-nowrap py-2 pl-3 pr-4 text-right text-sm sm:pr-0"><button type="button" class="text-error remove-btn font-bold">×</button></td>`;
        const overtimeTable = initializeDynamicTable('overtime-employees-tbody', 'add-overtime-employee-btn', 'total-overtime-hours-cell', 'summary-overtime-hours', 'hours-overtime', overtimeNewRowHtml);
        setupCopyButton('copy-yesterday-overtime-btn', 'overtime-employees-tbody', previousDayData.overtime, overtimeTable);
    });
</script>
</html>