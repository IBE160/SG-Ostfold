<!DOCTYPE html>
<html class="dark" lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>ibe160 Dashboard</title>
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;900&amp;display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script id="tailwind-config">
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              "primary": "#3abff8", // This will be used for standard KPIs and accents
              "background-light": "#f5f7f8",
              "background-dark": "#111827",
              "content-dark": "#1f2937",
              "border-dark": "#374151",
              "text-primary-dark": "#d1d5db",
              "text-secondary-dark": "#9ca3af",
              "success": "#22c55e",
              "error": "#f43f5e"
            },
            fontFamily: {
              "display": ["Inter", "sans-serif"]
            },
            borderRadius: {"DEFAULT": "0.25rem", "lg": "0.5rem", "xl": "0.75rem", "full": "9999px"},
          },
        },
      }
    </script>
</head>
<body class="font-display bg-background-light dark:bg-background-dark">
<div class="relative flex h-auto min-h-screen w-full flex-col">
    <div class="flex h-full grow">
        <main class="flex flex-1 flex-col transition-all duration-300 ease-in-out">
            <div class="flex-1 p-8">
                <header class="flex flex-col gap-6 mb-8">
                    <div class="flex flex-wrap items-center justify-between gap-4">
                        <h1 class="text-text-primary-dark text-4xl font-black leading-tight tracking-[-0.033em]">Dashboard</h1>
                        <div class="relative">
                            <button id="time-range-button" class="flex h-10 shrink-0 items-center justify-center gap-x-2 rounded-lg bg-content-dark pl-4 pr-3 border border-border-dark hover:border-primary/50 transition-colors duration-200">
                                <p id="time-range-text" class="text-text-primary-dark text-sm font-medium leading-normal">Last 30 Days</p>
                                <span class="material-symbols-outlined text-text-secondary-dark" style="font-size: 20px;">expand_more</span>
                            </button>
                            <div id="time-range-dropdown" class="absolute right-0 mt-2 w-48 bg-content-dark border border-border-dark rounded-lg shadow-lg hidden">
                                <a href="#" class="block px-4 py-2 text-sm text-text-primary-dark hover:bg-primary/20">Last year</a>
                                <a href="#" class="block px-4 py-2 text-sm text-text-primary-dark hover:bg-primary/20">Last 3 months</a>
                                <a href="#" class="block px-4 py-2 text-sm text-text-primary-dark hover:bg-primary/20">Last 1 month</a>
                                <a href="#" class="block px-4 py-2 text-sm text-text-primary-dark hover:bg-primary/20">Last 3 weeks</a>
                                <a href="#" class="block px-4 py-2 text-sm text-text-primary-dark hover:bg-primary/20">Last week</a>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button class="shift-button px-4 py-2 rounded-lg bg-primary/20 text-primary text-sm font-medium transition-colors duration-200" data-shift="Totalt">Totalt</button>
                        <button class="shift-button px-4 py-2 rounded-lg text-text-secondary-dark hover:bg-content-dark text-sm font-medium transition-colors duration-200" data-shift="Drift 1">Drift 1</button>
                        <button class="shift-button px-4 py-2 rounded-lg text-text-secondary-dark hover:bg-content-dark text-sm font-medium transition-colors duration-200" data-shift="Drift 2">Drift 2</button>
                        <button class="shift-button px-4 py-2 rounded-lg text-text-secondary-dark hover:bg-content-dark text-sm font-medium transition-colors duration-200" data-shift="Drift 3">Drift 3</button>
                    </div>
                </header>

                <div class="grid grid-cols-5 gap-8">
                    <div class="col-span-1 space-y-8">
                        <div id="kpi-efficiency" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Efficiency Score</p>
                            <p class="text-primary tracking-light text-4xl font-bold leading-tight">88%</p>
                        </div>
                        <div id="kpi-downtime" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Unplanned Downtime</p>
                            <p class="text-error tracking-light text-4xl font-bold leading-tight">3.5 hrs</p>
                        </div>
                        <div id="kpi-sick-leave" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Sick Leave (vs. Avg)</p>
                            <p class="text-success tracking-light text-4xl font-bold leading-tight">↓ 2%</p>
                        </div>
                        <div id="kpi-overtime" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Overtime (vs. Avg)</p>
                            <p class="text-error tracking-light text-4xl font-bold leading-tight">↑ 15%</p>
                        </div>
                        <div id="kpi-avg-orders" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Avg. Orders/Hr</p>
                            <p class="text-primary tracking-light text-4xl font-bold leading-tight">120</p>
                        </div>
                    </div>

                    <div class="col-span-3">
                        <section id="main-graph-container" class="bg-content-dark p-6 rounded-lg border border-border-dark" style="min-height: 448px;">
                            <div class="flex flex-col gap-2 h-full">
                                <p id="main-graph-title" class="text-text-primary-dark text-base font-medium leading-normal">Orders per Hour: Trend & Forecast</p>
                                <div class="flex min-h-[220px] flex-1 flex-col justify-end pt-4">
                                    <canvas id="main-chart"></canvas>
                                </div>
                            </div>
                        </section>
                    </div>

                    <div class="col-span-1 space-y-8">
                        <div id="kpi-quality" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Quality Pass Rate</p>
                            <p class="text-success tracking-light text-4xl font-bold leading-tight">99.2%</p>
                        </div>
                        <div id="kpi-maintenance" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Scheduled Maintenance</p>
                            <p class="text-primary tracking-light text-4xl font-bold leading-tight">2 days</p>
                        </div>
                        <div id="kpi-satisfaction" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Customer Satisfaction</p>
                            <p class="text-primary tracking-light text-4xl font-bold leading-tight">95%</p>
                        </div>
                        <div id="kpi-new-users" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">New Users</p>
                            <p class="text-success tracking-light text-4xl font-bold leading-tight">↑ 10%</p>
                        </div>
                        <div id="kpi-tickets" class="kpi-card flex flex-col gap-2 rounded-lg p-6 bg-content-dark border border-border-dark cursor-pointer">
                            <p class="text-text-secondary-dark text-base font-medium leading-normal">Support Tickets (Closed)</p>
                            <p class="text-primary tracking-light text-4xl font-bold leading-tight">85</p>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
<script>
    const kpiData = {
        'Totalt': {
            'kpi-efficiency': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 85),
            'kpi-downtime': Array.from({length: 30}, () => Math.floor(Math.random() * 5)),
            'kpi-sick-leave': Array.from({length: 30}, () => Math.floor(Math.random() * 5)),
            'kpi-overtime': Array.from({length: 30}, () => Math.floor(Math.random() * 20)),
            'kpi-avg-orders': Array.from({length: 30}, () => Math.floor(Math.random() * 50) + 100),
            'kpi-quality': Array.from({length: 30}, () => Math.floor(Math.random() * 5) + 95),
            'kpi-maintenance': Array.from({length: 30}, () => Math.floor(Math.random() * 7)),
            'kpi-satisfaction': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 90),
            'kpi-new-users': Array.from({length: 30}, () => Math.floor(Math.random() * 20) + 50),
            'kpi-tickets': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 80),
        },
        'Drift 1': {
            'kpi-efficiency': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 80),
            'kpi-downtime': Array.from({length: 30}, () => Math.floor(Math.random() * 3)),
            'kpi-sick-leave': Array.from({length: 30}, () => Math.floor(Math.random() * 2)),
            'kpi-overtime': Array.from({length: 30}, () => Math.floor(Math.random() * 10)),
            'kpi-avg-orders': Array.from({length: 30}, () => Math.floor(Math.random() * 30) + 80),
            'kpi-quality': Array.from({length: 30}, () => Math.floor(Math.random() * 3) + 97),
            'kpi-maintenance': Array.from({length: 30}, () => Math.floor(Math.random() * 4)),
            'kpi-satisfaction': Array.from({length: 30}, () => Math.floor(Math.random() * 5) + 95),
            'kpi-new-users': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 40),
            'kpi-tickets': Array.from({length: 30}, () => Math.floor(Math.random() * 5) + 70),
        },
        'Drift 2': {
            'kpi-efficiency': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 82),
            'kpi-downtime': Array.from({length: 30}, () => Math.floor(Math.random() * 4)),
            'kpi-sick-leave': Array.from({length: 30}, () => Math.floor(Math.random() * 3)),
            'kpi-overtime': Array.from({length: 30}, () => Math.floor(Math.random() * 15)),
            'kpi-avg-orders': Array.from({length: 30}, () => Math.floor(Math.random() * 40) + 90),
            'kpi-quality': Array.from({length: 30}, () => Math.floor(Math.random() * 4) + 96),
            'kpi-maintenance': Array.from({length: 30}, () => Math.floor(Math.random() * 5)),
            'kpi-satisfaction': Array.from({length: 30}, () => Math.floor(Math.random() * 7) + 92),
            'kpi-new-users': Array.from({length: 30}, () => Math.floor(Math.random() * 15) + 45),
            'kpi-tickets': Array.from({length: 30}, () => Math.floor(Math.random() * 8) + 75),
        },
        'Drift 3': {
            'kpi-efficiency': Array.from({length: 30}, () => Math.floor(Math.random() * 10) + 88),
            'kpi-downtime': Array.from({length: 30}, () => Math.floor(Math.random() * 2)),
            'kpi-sick-leave': Array.from({length: 30}, () => Math.floor(Math.random() * 1)),
            'kpi-overtime': Array.from({length: 30}, () => Math.floor(Math.random() * 5)),
            'kpi-avg-orders': Array.from({length: 30}, () => Math.floor(Math.random() * 60) + 110),
            'kpi-quality': Array.from({length: 30}, () => Math.floor(Math.random() * 2) + 98),
            'kpi-maintenance': Array.from({length: 30}, () => Math.floor(Math.random() * 2)),
            'kpi-satisfaction': Array.from({length: 30}, () => Math.floor(Math.random() * 3) + 97),
            'kpi-new-users': Array.from({length: 30}, () => Math.floor(Math.random() * 25) + 55),
            'kpi-tickets': Array.from({length: 30}, () => Math.floor(Math.random() * 12) + 85),
        },
    };

    const kpiCards = document.querySelectorAll('.kpi-card');
    const mainGraphTitle = document.getElementById('main-graph-title');
    const shiftButtons = document.querySelectorAll('.shift-button');
    const timeRangeButton = document.getElementById('time-range-button');
    const timeRangeText = document.getElementById('time-range-text');
    const timeRangeDropdown = document.getElementById('time-range-dropdown');
    const ctx = document.getElementById('main-chart').getContext('2d');
    let myChart;
    let currentShift = 'Totalt';
    let currentKpi = 'kpi-avg-orders';

    const renderChart = (data, label) => {
        if (myChart) {
            myChart.destroy();
        }
        myChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: Array.from({length: data.length}, (_, i) => i + 1),
                datasets: [{
                    label: label,
                    data: data,
                    borderColor: '#3abff8',
                    backgroundColor: 'rgba(58, 191, 248, 0.2)',
                    tension: 0.4,
                    fill: true,
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(255, 255, 255, 0.1)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: false
                    }
                }
            }
        });
    }
    
    const updateDashboard = () => {
        // Update KPI cards
        kpiCards.forEach(card => {
            const kpiId = card.id;
            const data = kpiData[currentShift][kpiId];
            const lastValue = data[data.length - 1];
            // This is a simplification, in a real app you would have a more sophisticated way to display the KPI value
            card.querySelector('p:last-child').textContent = lastValue;
        });

        // Update graph
        const kpiLabel = document.querySelector(`#${currentKpi} p:first-child`).textContent;
        mainGraphTitle.textContent = `${kpiLabel}: ${timeRangeText.textContent} (${currentShift})`;
        renderChart(kpiData[currentShift][currentKpi], kpiLabel);

        // Update active card
        kpiCards.forEach(c => c.style.borderColor = 'var(--border-dark)');
        document.getElementById(currentKpi).style.borderColor = 'var(--primary)';
    };

    kpiCards.forEach(card => {
        card.addEventListener('click', () => {
            currentKpi = card.id;
            updateDashboard();
        });
    });

    shiftButtons.forEach(button => {
        button.addEventListener('click', () => {
            currentShift = button.dataset.shift;
            
            shiftButtons.forEach(btn => {
                btn.classList.remove('bg-primary/20', 'text-primary');
                btn.classList.add('text-text-secondary-dark', 'hover:bg-content-dark');
            });
            button.classList.add('bg-primary/20', 'text-primary');
            button.classList.remove('text-text-secondary-dark', 'hover:bg-content-dark');
            
            updateDashboard();
        });
    });
    
    timeRangeButton.addEventListener('click', () => {
        timeRangeDropdown.classList.toggle('hidden');
    });

    document.addEventListener('click', (event) => {
        if (!timeRangeButton.contains(event.target) && !timeRangeDropdown.contains(event.target)) {
            timeRangeDropdown.classList.add('hidden');
        }
    });

    timeRangeDropdown.addEventListener('click', (event) => {
        if (event.target.tagName === 'A') {
            timeRangeText.textContent = event.target.textContent;
            timeRangeDropdown.classList.add('hidden');
            // Here you would typically re-fetch data based on the new time range
            // For now, we just update the title
            updateDashboard();
        }
    });
    
    // Initial dashboard render
    updateDashboard();

</script>
<script defer="" src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>
